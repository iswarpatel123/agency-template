---
import QuantityHeader from './QuantityHeader.astro';
import QuantityOption from './QuantityOption.astro';
---

<div class="quantity-selector">
  <div class="selector-container">
    <QuantityHeader />
    
    <div class="options">
      <QuantityOption
        pairs={1}
        pricePerPair={69.99}
        originalPrice={139.99}
        savePercentage={50}
      />
      
      <QuantityOption
        pairs={2}
        pricePerPair={62.99}
        originalPrice={139.99}
        savePercentage={55}
        badge="Most Popular"
        selected={true}
      />
      
      <QuantityOption
        pairs={3}
        pricePerPair={55.99}
        originalPrice={139.99}
        savePercentage={60}
        badge="Best Deal"
      />
    </div>

    <div class="px-4 mb-4">
      <button class="cta-button" onclick="document.querySelector('.color-size-selector').scrollIntoView({ behavior: 'smooth' })">
        Select Your Color and Size <span class="arrow">â†’</span>
      </button>
    </div>

    <div class="payment-info">
      <img src="https://offer.groundedfootwear.co/freedom/en/us/v1/img/bundle-cards.png" alt="Payment methods" class="payment-cards" />
    </div>
  </div>
</div>

<script>
  const options = document.querySelectorAll('input[type="radio"]');
  options.forEach(option => {
    option.addEventListener('change', (e) => {
      const quantity = parseInt((e.target as HTMLInputElement).value);
      localStorage.setItem('selectedQuantity', quantity.toString());
      window.dispatchEvent(new CustomEvent('quantityChange', { detail: quantity }));

      // Update selected class
      document.querySelectorAll('.option').forEach(el => el.classList.remove('selected'));
      const optionElement = (e.target as HTMLInputElement).closest('.option');
      if (optionElement) {
        optionElement.classList.add('selected');
      }
    });
  });
</script>

<style>
  .quantity-selector {
    max-width: 600px;
    margin: 0 auto;
  }

  .quantity-selector + .color-size-selector {
    margin-top: 2rem;
  }

  .selector-container {
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    background: white;
    overflow: hidden;
  }

  .options {
    padding: 0.5rem 1rem;
  }

  .cta-button {
    width: 100%;
    border-radius: 0.5rem;
    background: #fbbf24;
    color: #000;
    border: none;
    padding: 1rem 1.5rem;
    font-size: 1.125rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: background-color 0.2s;
  }

  .cta-button:hover {
    background: #f59e0b;
  }

  .arrow {
    font-size: 1.25rem;
  }

  .payment-info {
    padding: 1rem;
    display: flex;
    justify-content: center;
  }

  .payment-cards {
    max-width: 300px;
    height: auto;
  }
</style>
